---
title: "Assignment 5"
author: "AnnaClaire Marley"
date: "11/28/2018"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)



faculty <- read_csv("Faculty_salary_data_cleaned.csv")
grad <- read_csv("Grad_enrollment_cleaned.csv")
grad2 <- read_csv("Grad_enroll_clean2.csv")
median <- read_csv("Median_salary_cleaned.csv")
phd_fields <- read_csv("F_PhD_Fields.csv")
phd_tidy <- read_csv("PhD_tidy.csv")
phd_chi <-read_csv("Field_chisquared.csv")

```


1. Male and female graduate enrollment (1967 - 2015). Compare trends in total graduate enrollment for males and females (including full-time/part-time and private/public universities) in the United States from 1967 - 2015. Describe your results statistically, graphically and in text. 

**reminder: cannot split public_all/private_All by gender does not equate to gender column**

```{r}
# Exploratory line graphs

# full time enrollment men vs women
full_time <- grad2 %>% 
  ggplot(aes(x = Year, y = Full_time)) +
  geom_line(aes(color = Gender)) +
  theme_classic() +
  labs(
    x = "Year",
    y = "Full Time Enrollment in Post-Secondary Institutions"
  ) +
  scale_x_continuous(expand=c(0,0))

full_time

# part time enrollment men vs women 

part_time <- grad2 %>% 
  ggplot(aes(x = Year, y = Part_time)) +
  geom_line(aes(color = Gender)) +
  theme_classic() +
  labs(
    x = "Year",
    y = "Part Time Enrollment in Post-Secondary Institutions"
  ) +
  scale_x_continuous(expand=c(0,0))

part_time


```


2. Shifts in female PhD recipients by field (1985, 2000, and 2015). Describe if and how there was a shift in PhDs awarded to females in four fields (Physical and Earth Sciences, Engineering, Education, and Humanities & Arts) in 1985, 2000, and 2015. Describe your results statistically, in a graph or table, and in text. Note: There are several ways that you can interpret this question. You are invited to decide which you think is/are most interesting. Just be really clear about what you are asking/answering in your report.

```{r}

# exploratory column graph

phd_shifts <- phd_tidy %>% 
  filter(Field == "Physical science" | Field == "Engineering" | Field == "Education" | Field == "Humanities", Sex    == "F") %>% 
  ggplot(aes(x = Year, y = Number)) +
  geom_col(aes(fill = Field), position = "dodge") +
  scale_x_continuous(expand=c(0,0), breaks = seq(1985,2015, by=15)) +
  scale_y_continuous(expand=c(0,0)) +
  theme_classic() +
  labs(
    x = "Year",
    y = "Female PhDs Awarded"
  )

phd_shifts

#chi squared test on female "is there a sigificant difference in females who chose a particular field in 1985, 2000 and 2015?"

#Ho - there is no association between year and number of women in each field 
#Ha - there IS an association between year and number of women in each field 


phd_chi2 <- phd_chi %>% 
  select(-Year) %>%
  filter(physical != "NA")

row.names(phd_chi2) <- c("1985","2000","2015")

#Perform chi-square 

phd_x2test <- chisq.test(phd_chi2) 

phd_x2test

#we reject the null hypothesis beacuse the p-value is < .001. The field in which women receive their doctoral degrees differs significantly between 1985, 2000 and 2015. There is a significant association between year and number of docotoral degrees awarded to women in each field. 

```


3. Male and female salaries for starting postdoctoral and other employment positions (2015). Compare median salaries for male and female doctorate recipients in 2015. Answer these two questions: Does median salary differ significantly between male and female starting postdoc positions? Does median salary differ significantly between male and female PhD recipients in non-postdoc employment positions?

```{r}
# Comparing medians use Mann-Whitney U.

################## Compare median salaries for post-doc positions ################

# Explotory histogram - male median salaries 
# bins
k <- 2*((NROW(na.omit(median$`Emp M`)))^(1/3))

empmale_hist <- ggplot(median, aes(x = `Emp M`)) +
  geom_histogram(bins = k) +
  theme_classic() +
  scale_x_continuous(expand = c(0,0)) +
  scale_y_continuous (expand = c(0,0))
empmale_hist

# noraml - heavily concentrated in the middle bins, very few above or below 

# Exploratory QQ - male median salary 

empmale_qq <- ggplot(median, aes(sample = `Emp M`)) +
  geom_qq() 
empmale_qq

# appears normal

# histogram - female median salary
#bins
k <- 2*((NROW(na.omit(median$`Emp F`)))^(1/3))

empfemale_hist <- ggplot(median, aes(x = `Emp F`)) +
  geom_histogram(bins = k) +
  theme_classic() +
  scale_x_continuous(expand = c(0,0)) +
  scale_y_continuous (expand = c(0,0))
empfemale_hist

# normal - also heavily concentrated in the center bins - very few observations above and below 

# Exploratory QQ - female median salary 

empfemale_qq <- ggplot(median, aes(sample = `Emp F`)) +
  geom_qq() 
empfemale_qq

# appears relatively normal

# Mann-Whitney U

# HO: Ranks are equal (medians are equal)
# HA: Ranks are NOT equal

emp_mwu <- wilcox.test(median$`Emp M`, median$`Emp F`)
emp_mwu
# W = 136.5 p-value = 0.3289 (NOT significant)

# Cliffs Delta (effect size)

emp_cliff <- cliff.delta(median$`Emp M`, median$`Emp F`)
emp_cliff
# Cliff delta = 0.213 (small)

# Actual difference in medians 

emp_male_median <- median(median$`Emp M`)
emp_female_median <- median(median$`Emp F`)
emp_male_median - emp_female_median
# median male = 75167
# median female = 71750
# difference male - female = 3417

################### compare median salaries for non-postdoc positions ################

# Explotory histogram - male median salaries 
# bins
k <- 2*((NROW(na.omit(median$`PS M`)))^(1/3))

psmale_hist <- ggplot(median, aes(x = `PS M`)) +
  geom_histogram(bins = k) +
  theme_classic() +
  scale_x_continuous(expand = c(0,0)) +
  scale_y_continuous (expand = c(0,0))
psmale_hist

# normal - more evenly spread 

# Exploratory QQ - male median salary 

psmale_qq <- ggplot(median, aes(sample = `PS M`)) +
  geom_qq() 
psmale_qq

# overall normal, a few more abnormal points between theoretical 0 and 1 

# histogram - female median salary
#bins
k <- 2*((NROW(na.omit(median$`PS F`)))^(1/3))

psfemale_hist <- ggplot(median, aes(x = `PS F`)) +
  geom_histogram(bins = k) +
  theme_classic() +
  scale_x_continuous(expand = c(0,0)) +
  scale_y_continuous (expand = c(0,0))
psfemale_hist

# relatively normal  

# Exploratory QQ - female median salary 

psfemale_qq <- ggplot(median, aes(sample = `PS F`)) +
  geom_qq() 
psfemale_qq

# overall relatively normal

# Mann-Whitney U

# HO: Ranks are equal (medians are equal)
# HA: Ranks are NOT equal

ps_mwu <- wilcox.test(median$`PS M`, median$`PS F`)
ps_mwu

# W = 117 p-value = 0.8671 (NOT significant)

# Cliffs Delta (effect size)

ps_cliff <- cliff.delta(median$`PS M`, median$`PS F`)
ps_cliff
# Cliff delta = 0.04 (negligible)

# Actual difference in medians 

ps_male_median <- median(median$`PS M`)
ps_female_median <- median(median$`PS F`)
ps_male_median - ps_female_median
# median male = 48000
# median female = 45000
# difference male - female = 3000

```


4. Exploring academic salaries for professors in U.S. colleges. Explore relationships between variables in the ‘Faculty salary data (2008 - 2009 survey)’ dataset. Develop a model describing faculty salary based on data for faculty sex, rank, years in current position, field, and number of years since doctoral degree was earned. You should make decisions regarding which variables should remain in your final model. Describe the results qualitatively and quantitatively (i.e., don’t just report the statistical results of the model – make sure you describe interesting findings in text). You can also discuss any concerns that you have with the model(s) you present, if any.

```{r}



```








